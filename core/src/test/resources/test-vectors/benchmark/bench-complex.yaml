# Benchmark fixture: complex transform with nested structures and array iteration
# Used by TransformEngineBenchmark for NFR-001-03 — worst-case scenario.

id: bench-complex
version: "1.0.0"
description: "Complex transform — nested object + array reshaping"

input:
  schema:
    type: object
    properties:
      totalResults:
        type: integer
      Resources:
        type: array
        items:
          type: object

output:
  schema:
    type: object
    properties:
      total:
        type: integer
      users:
        type: array
        items:
          type: object

transform:
  lang: jslt
  expr: |
    {
      "total": .totalResults,
      "users": [for (.Resources)
        {
          "id": .id,
          "username": .userName,
          "displayName": .displayName,
          "email": .emails[0].value,
          "active": .active,
          "status": if (.active) "enabled" else "disabled",
          "role": if (.role) .role else "user"
        }
      ]
    }
